# Generated by Django 5.1.7 on 2025-09-01 13:49

import datetime
import django.db.models.deletion
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ('almacenes', '0001_initial'),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.AlterModelOptions(
            name='lote',
            options={'verbose_name': 'Lote', 'verbose_name_plural': 'Lotes'},
        ),
        migrations.RemoveField(
            model_name='lote',
            name='fecha_ingreso',
        ),
        migrations.AddField(
            model_name='componente',
            name='activo',
            field=models.BooleanField(default=True),
        ),
        migrations.AddField(
            model_name='estadoequipo',
            name='activo',
            field=models.BooleanField(default=True),
        ),
        migrations.AddField(
            model_name='lote',
            name='codigo_nota_ingreso',
            field=models.CharField(default=1000000, help_text='Código de nota de ingreso SPRINT (6-10 dígitos)', max_length=10),
            preserve_default=False,
        ),
        migrations.AddField(
            model_name='lote',
            name='codigo_requerimiento_compra',
            field=models.CharField(default=1000001, help_text='Código de requerimiento de compra SPRINT (6-10 dígitos)', max_length=10),
            preserve_default=False,
        ),
        migrations.AddField(
            model_name='lote',
            name='created_by',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='lotes_creados', to=settings.AUTH_USER_MODEL),
        ),
        migrations.AddField(
            model_name='lote',
            name='detalles_informe',
            field=models.TextField(blank=True, help_text='Detalles del informe de laboratorio'),
        ),
        migrations.AddField(
            model_name='lote',
            name='estado',
            field=models.CharField(choices=[('REGISTRADO', 'Registrado'), ('PENDIENTE_RECEPCION', 'Pendiente Recepción'), ('RECEPCION_PARCIAL', 'Recepción Parcial'), ('RECEPCION_COMPLETA', 'Recepción Completa'), ('ACTIVO', 'Activo'), ('CERRADO', 'Cerrado')], default='REGISTRADO', max_length=25),
        ),
        migrations.AddField(
            model_name='lote',
            name='fecha_fin_garantia',
            field=models.DateField(default=datetime.date(2025, 9, 1), help_text='Fin de garantía'),
            preserve_default=False,
        ),
        migrations.AddField(
            model_name='lote',
            name='fecha_informe',
            field=models.DateField(blank=True, help_text='Fecha del informe de laboratorio', null=True),
        ),
        migrations.AddField(
            model_name='lote',
            name='fecha_inicio_garantia',
            field=models.DateField(default=datetime.date(2025, 9, 1), help_text='Inicio de garantía'),
            preserve_default=False,
        ),
        migrations.AddField(
            model_name='lote',
            name='fecha_recepcion',
            field=models.DateField(default=datetime.date(2025, 9, 1), help_text='Fecha de recepción del lote'),
            preserve_default=False,
        ),
        migrations.AddField(
            model_name='lote',
            name='numero_informe',
            field=models.CharField(blank=True, help_text='Número de informe de laboratorio', max_length=50),
        ),
        migrations.AddField(
            model_name='lote',
            name='tipo_ingreso',
            field=models.CharField(choices=[('NUEVO', 'Nuevo'), ('REINGRESO', 'Reingreso'), ('DEVOLUCION', 'Devolución'), ('LABORATORIO', 'Laboratorio')], default='NUEVO', max_length=20),
        ),
        migrations.AddField(
            model_name='lote',
            name='total_entregas_parciales',
            field=models.PositiveIntegerField(default=0),
        ),
        migrations.AddField(
            model_name='marca',
            name='activo',
            field=models.BooleanField(default=True),
        ),
        migrations.AddField(
            model_name='modelo',
            name='activo',
            field=models.BooleanField(default=True),
        ),
        migrations.AddField(
            model_name='modelo',
            name='cantidad_por_unidad',
            field=models.DecimalField(decimal_places=2, default=1.0, help_text='Cantidad por unidad (ej: metros por rollo, piezas por caja)', max_digits=10),
        ),
        migrations.AddField(
            model_name='modelo',
            name='requiere_inspeccion_inicial',
            field=models.BooleanField(default=True, help_text='Indica si requiere inspección en laboratorio al ingresar como NUEVO'),
        ),
        migrations.AddField(
            model_name='modelo',
            name='tipo_material',
            field=models.CharField(choices=[('ONU', 'Equipo ONU'), ('CABLE_DROP', 'Cable Drop'), ('CONECTOR_APC', 'Conector APC'), ('CONECTOR_UPC', 'Conector UPC'), ('ROSETA_OPTICA', 'Roseta Óptica'), ('PATCH_CORE', 'Patch Core'), ('TRIPLEXOR', 'Triplexor'), ('OTRO', 'Otro Material')], default='ONU', help_text='Tipo de material que representa este modelo', max_length=20),
        ),
        migrations.AddField(
            model_name='modelo',
            name='unidad_medida',
            field=models.CharField(choices=[('PIEZA', 'Pieza'), ('UNIDAD', 'Unidad'), ('METROS', 'Metros'), ('CAJA', 'Caja'), ('ROLLO', 'Rollo'), ('KIT', 'Kit'), ('PAQUETE', 'Paquete')], default='PIEZA', help_text='Unidad de medida para este tipo de material', max_length=15),
        ),
        migrations.AddField(
            model_name='tipoequipo',
            name='activo',
            field=models.BooleanField(default=True),
        ),
        migrations.AlterField(
            model_name='lotedetalle',
            name='cantidad',
            field=models.IntegerField(default=0, help_text='Cantidad esperada de este modelo'),
        ),
        migrations.CreateModel(
            name='Almacen',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('codigo', models.CharField(help_text='Código único del almacén', max_length=10, unique=True)),
                ('nombre', models.CharField(help_text='Nombre del almacén', max_length=100)),
                ('ciudad', models.CharField(help_text='Ciudad donde se ubica', max_length=50)),
                ('tipo', models.CharField(choices=[('PRINCIPAL', 'Principal'), ('REGIONAL', 'Regional'), ('TEMPORAL', 'Temporal')], default='REGIONAL', max_length=20)),
                ('direccion', models.TextField(blank=True, help_text='Dirección física')),
                ('es_principal', models.BooleanField(default=False, help_text='Indica si es el almacén principal')),
                ('activo', models.BooleanField(default=True)),
                ('observaciones', models.TextField(blank=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='almacenes_creados', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Almacén',
                'verbose_name_plural': 'Almacenes',
                'db_table': 'almacenes_almacen',
            },
        ),
        migrations.AddField(
            model_name='lote',
            name='almacen_destino',
            field=models.ForeignKey(default=1, help_text='Almacén donde se reciben los materiales', on_delete=django.db.models.deletion.CASCADE, to='almacenes.almacen'),
            preserve_default=False,
        ),
        migrations.CreateModel(
            name='Proveedor',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('codigo', models.CharField(blank=True, help_text='Código interno del proveedor', max_length=20)),
                ('nombre_comercial', models.CharField(help_text='Nombre comercial del proveedor', max_length=100, unique=True)),
                ('razon_social', models.CharField(blank=True, max_length=150)),
                ('contacto_principal', models.CharField(blank=True, max_length=100)),
                ('telefono', models.CharField(blank=True, max_length=20)),
                ('email', models.EmailField(blank=True, max_length=254)),
                ('activo', models.BooleanField(default=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='proveedores_creados', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Proveedor',
                'verbose_name_plural': 'Proveedores',
                'db_table': 'almacenes_proveedor',
            },
        ),
        migrations.CreateModel(
            name='DevolucionProveedor',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('numero_devolucion', models.CharField(help_text='Número único de devolución', max_length=20, unique=True)),
                ('motivo', models.TextField(help_text='Motivo de la devolución basado en informe de laboratorio')),
                ('numero_informe_laboratorio', models.CharField(help_text='Número de informe de laboratorio que justifica la devolución', max_length=50)),
                ('estado', models.CharField(choices=[('PENDIENTE', 'Pendiente'), ('ENVIADO', 'Enviado'), ('CONFIRMADO', 'Confirmado'), ('RECHAZADO', 'Rechazado')], default='PENDIENTE', max_length=15)),
                ('fecha_creacion', models.DateTimeField(auto_now_add=True)),
                ('fecha_envio', models.DateTimeField(blank=True, null=True)),
                ('fecha_confirmacion', models.DateTimeField(blank=True, null=True)),
                ('respuesta_proveedor', models.CharField(choices=[('REPOSICION', 'Reposición'), ('CREDITO', 'Crédito'), ('RECHAZO', 'Rechazo'), ('PENDIENTE', 'Pendiente')], default='PENDIENTE', max_length=15)),
                ('observaciones_proveedor', models.TextField(blank=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('created_by', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='devoluciones_creadas', to=settings.AUTH_USER_MODEL)),
                ('lote_origen', models.ForeignKey(help_text='Lote de donde provienen los materiales', on_delete=django.db.models.deletion.CASCADE, to='almacenes.lote')),
                ('proveedor', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='almacenes.proveedor')),
            ],
            options={
                'verbose_name': 'Devolución a Proveedor',
                'verbose_name_plural': 'Devoluciones a Proveedores',
                'db_table': 'almacenes_devolucion_proveedor',
            },
        ),
        migrations.AlterField(
            model_name='lote',
            name='proveedor',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='almacenes.proveedor'),
        ),
        migrations.CreateModel(
            name='TraspasoAlmacen',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('numero_traspaso', models.CharField(help_text='Número único de traspaso generado automáticamente', max_length=20, unique=True)),
                ('numero_solicitud', models.CharField(help_text='Número de solicitud (6-10 dígitos)', max_length=10)),
                ('fecha_envio', models.DateTimeField(help_text='Fecha y hora de envío')),
                ('fecha_recepcion', models.DateTimeField(blank=True, help_text='Fecha y hora de recepción', null=True)),
                ('estado', models.CharField(choices=[('PENDIENTE', 'Pendiente'), ('EN_TRANSITO', 'En Tránsito'), ('RECIBIDO', 'Recibido'), ('CANCELADO', 'Cancelado')], default='PENDIENTE', max_length=15)),
                ('cantidad_enviada', models.PositiveIntegerField(help_text='Cantidad de materiales enviados')),
                ('cantidad_recibida', models.PositiveIntegerField(default=0, help_text='Cantidad de materiales recibidos')),
                ('motivo', models.TextField(help_text='Motivo del traspaso')),
                ('observaciones_envio', models.TextField(blank=True)),
                ('observaciones_recepcion', models.TextField(blank=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('almacen_destino', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='traspasos_entrada', to='almacenes.almacen')),
                ('almacen_origen', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='traspasos_salida', to='almacenes.almacen')),
                ('usuario_envio', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='traspasos_enviados', to=settings.AUTH_USER_MODEL)),
                ('usuario_recepcion', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='traspasos_recibidos', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Traspaso de Almacén',
                'verbose_name_plural': 'Traspasos de Almacén',
                'db_table': 'almacenes_traspaso_almacen',
            },
        ),
        migrations.CreateModel(
            name='Material',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('codigo_interno', models.CharField(help_text='Código interno único generado automáticamente', max_length=50, unique=True)),
                ('tipo_material', models.CharField(choices=[('ONU', 'Equipo ONU'), ('CABLE_DROP', 'Cable Drop'), ('CONECTOR_APC', 'Conector APC'), ('CONECTOR_UPC', 'Conector UPC'), ('ROSETA_OPTICA', 'Roseta Óptica'), ('PATCH_CORE', 'Patch Core'), ('TRIPLEXOR', 'Triplexor'), ('OTRO', 'Otro Material')], help_text='Tipo de material', max_length=20)),
                ('mac_address', models.CharField(blank=True, help_text='MAC Address para equipos ONU', max_length=17, null=True, unique=True)),
                ('gpon_serial', models.CharField(blank=True, help_text='GPON Serial para equipos ONU', max_length=100, null=True, unique=True)),
                ('serial_manufacturer', models.CharField(blank=True, help_text='D-SN/Serial Manufacturer para equipos ONU', max_length=100, null=True, unique=True)),
                ('codigo_barras', models.CharField(blank=True, help_text='Código de barras o identificador alternativo', max_length=100)),
                ('especificaciones_tecnicas', models.JSONField(blank=True, default=dict, help_text='Especificaciones técnicas del material')),
                ('codigo_item_equipo', models.CharField(help_text='Código SPRINT Item Equipo (6-10 dígitos)', max_length=10)),
                ('estado_onu', models.CharField(blank=True, choices=[('NUEVO', 'Nuevo'), ('DISPONIBLE', 'Disponible'), ('RESERVADO', 'Reservado'), ('ASIGNADO', 'Asignado'), ('INSTALADO', 'Instalado'), ('EN_LABORATORIO', 'En Laboratorio'), ('DEFECTUOSO', 'Defectuoso'), ('DEVUELTO_PROVEEDOR', 'Devuelto a Proveedor'), ('REINGRESADO', 'Reingresado'), ('DADO_DE_BAJA', 'Dado de Baja')], help_text='Estado específico para equipos ONU', max_length=25)),
                ('estado_general', models.CharField(choices=[('DISPONIBLE', 'Disponible'), ('RESERVADO', 'Reservado'), ('ASIGNADO', 'Asignado'), ('CONSUMIDO', 'Consumido'), ('DEFECTUOSO', 'Defectuoso'), ('DADO_DE_BAJA', 'Dado de Baja')], default='DISPONIBLE', help_text='Estado para otros materiales', max_length=20)),
                ('es_nuevo', models.BooleanField(default=True, help_text='TRUE solo en primera entrada, FALSE en reingresos')),
                ('tipo_origen', models.CharField(choices=[('NUEVO', 'Nuevo'), ('REINGRESO', 'Reingreso'), ('DEVOLUCION', 'Devolución'), ('LABORATORIO', 'Laboratorio')], default='NUEVO', help_text='Tipo de origen del material', max_length=20)),
                ('fecha_envio_laboratorio', models.DateTimeField(blank=True, null=True)),
                ('fecha_retorno_laboratorio', models.DateTimeField(blank=True, null=True)),
                ('cantidad', models.DecimalField(decimal_places=2, default=1.0, help_text='Cantidad para materiales no únicos (metros, unidades, etc.)', max_digits=10)),
                ('orden_trabajo', models.CharField(blank=True, help_text='Orden de trabajo asignada (futuro)', max_length=50)),
                ('observaciones', models.TextField(blank=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('almacen_actual', models.ForeignKey(help_text='Almacén donde se encuentra actualmente', on_delete=django.db.models.deletion.CASCADE, to='almacenes.almacen')),
                ('lote', models.ForeignKey(help_text='Lote de origen', on_delete=django.db.models.deletion.CASCADE, to='almacenes.lote')),
                ('modelo', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='almacenes.modelo')),
                ('tipo_equipo', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='almacenes.tipoequipo')),
                ('traspaso_actual', models.ForeignKey(blank=True, help_text='Traspaso en el que está involucrado actualmente', null=True, on_delete=django.db.models.deletion.SET_NULL, to='almacenes.traspasoalmacen')),
            ],
            options={
                'verbose_name': 'Material',
                'verbose_name_plural': 'Materiales',
                'db_table': 'almacenes_material',
            },
        ),
        migrations.CreateModel(
            name='HistorialMaterial',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('estado_anterior', models.CharField(blank=True, max_length=25)),
                ('estado_nuevo', models.CharField(max_length=25)),
                ('motivo', models.CharField(help_text='Motivo del cambio', max_length=100)),
                ('observaciones', models.TextField(blank=True)),
                ('fecha_cambio', models.DateTimeField(auto_now_add=True)),
                ('almacen_anterior', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='historiales_salida', to='almacenes.almacen')),
                ('almacen_nuevo', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='historiales_entrada', to='almacenes.almacen')),
                ('devolucion_relacionada', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to='almacenes.devolucionproveedor')),
                ('usuario_responsable', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to=settings.AUTH_USER_MODEL)),
                ('material', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='historial', to='almacenes.material')),
                ('traspaso_relacionado', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to='almacenes.traspasoalmacen')),
            ],
            options={
                'db_table': 'almacenes_historial_material',
                'ordering': ['-fecha_cambio'],
            },
        ),
        migrations.CreateModel(
            name='EntregaParcialLote',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('numero_entrega', models.PositiveIntegerField(help_text='Número de entrega parcial (1, 2, 3, etc.)')),
                ('fecha_entrega', models.DateField(help_text='Fecha de esta entrega parcial')),
                ('cantidad_entregada', models.PositiveIntegerField(help_text='Cantidad entregada en esta parte')),
                ('estado_entrega', models.CharField(choices=[('REGISTRADO', 'Registrado'), ('PENDIENTE_RECEPCION', 'Pendiente Recepción'), ('RECEPCION_PARCIAL', 'Recepción Parcial'), ('RECEPCION_COMPLETA', 'Recepción Completa'), ('ACTIVO', 'Activo'), ('CERRADO', 'Cerrado')], default='RECEPCION_PARCIAL', max_length=25)),
                ('observaciones', models.TextField(blank=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='entregas_parciales_creadas', to=settings.AUTH_USER_MODEL)),
                ('lote', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='entregas_parciales', to='almacenes.lote')),
            ],
            options={
                'db_table': 'almacenes_entrega_parcial_lote',
                'ordering': ['lote', 'numero_entrega'],
                'unique_together': {('lote', 'numero_entrega')},
            },
        ),
        migrations.CreateModel(
            name='DevolucionMaterial',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('motivo_especifico', models.TextField(blank=True, help_text='Motivo específico para este material')),
                ('devolucion', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='materiales_devueltos', to='almacenes.devolucionproveedor')),
                ('material', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='almacenes.material')),
            ],
            options={
                'db_table': 'almacenes_devolucion_material',
                'unique_together': {('devolucion', 'material')},
            },
        ),
        migrations.CreateModel(
            name='TraspasoMaterial',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('recibido', models.BooleanField(default=False)),
                ('observaciones', models.TextField(blank=True)),
                ('material', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='almacenes.material')),
                ('traspaso', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='materiales', to='almacenes.traspasoalmacen')),
            ],
            options={
                'db_table': 'almacenes_traspaso_material',
                'unique_together': {('traspaso', 'material')},
            },
        ),
    ]
